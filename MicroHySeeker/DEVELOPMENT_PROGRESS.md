# MicroHySeeker åç«¯å¼€å‘è¿›åº¦æ–‡æ¡£

**é¡¹ç›®**: MicroHySeeker ç”µåŒ–å­¦å·¥ä½œç«™æ§åˆ¶ç³»ç»Ÿ  
**æ›´æ–°æ—¥æœŸ**: 2026å¹´2æœˆ2æ—¥  
**å¼€å‘ç¯å¢ƒ**: Python 3.12.12 | Conda: MicroHySeeker  
**å‚è€ƒæ–‡æ¡£**: [MASTER_PLAN.md](docs/backend/MASTER_PLAN.md)

---

## ğŸ“Š é˜¶æ®µè¿›åº¦æ¦‚è§ˆ

| é˜¶æ®µ | åç§° | çŠ¶æ€ | å‰ç«¯éªŒè¯ | ç¡¬ä»¶éªŒè¯ |
|------|------|------|---------|---------|
| **é˜¶æ®µ1** | RS485åŸºç¡€ | âœ… å®Œæˆ | - | âœ… |
| **é˜¶æ®µ2** | æ³µç®¡ç† | âœ… å®Œæˆ | âœ… Mock + ç¡¬ä»¶ | âœ… 12ä¸ªæ³µå…¨éƒ¨æ­£å¸¸ |
| **é˜¶æ®µ3** | é…æ¶²åŠŸèƒ½ | ğŸ”„ å¾…å¼€å‘ | - | - |
| **é˜¶æ®µ4** | å†²æ´—åŠŸèƒ½ | ğŸ”„ å¾…å¼€å‘ | - | - |
| **é˜¶æ®µ5** | å®éªŒå¼•æ“ | ğŸ”„ å¾…å¼€å‘ | - | - |

---

## âœ… é˜¶æ®µ1ï¼šRS485åŸºç¡€ (å·²å®Œæˆ)

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ |
|------|------|------|
| RS485Driver | `src/echem_sdl/hardware/rs485_driver.py` | âœ… |
| RS485Protocol | `src/echem_sdl/hardware/rs485_protocol.py` | âœ… |

**éªŒè¯**: `test_rs485_connection.py` é€šè¿‡

---

## âœ… é˜¶æ®µ2ï¼šæ³µç®¡ç† (å·²å®Œæˆ)

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ |
|------|------|------|
| PumpManager | `src/echem_sdl/hardware/pump_manager.py` | âœ… |
| LibContext | `src/echem_sdl/lib_context.py` | âœ… |
| RS485Wrapper | `src/services/rs485_wrapper.py` | âœ… |

**éªŒè¯**: 
- `test_stage2_integration.py` é€šè¿‡ âœ…
- `test_scan_pump1.py` é€šè¿‡ âœ…
- `test_manual_control_pump1.py` é€šè¿‡ âœ…
- `test_real_hardware_pump1.py` é€šè¿‡ âœ…
- å‰ç«¯: æ‰‹åŠ¨æ§åˆ¶å¯¹è¯æ¡† (`src/dialogs/manual_control.py`) âœ…

**åŠŸèƒ½**:
- âœ… Mockæ¨¡å¼/ç¡¬ä»¶æ¨¡å¼åŠ¨æ€åˆ‡æ¢
- âœ… Mockæ¨¡å¼çŠ¶æ€æŒä¹…åŒ– (ä¿å­˜åˆ° config/system.json)
- âœ… è®¾å¤‡æ‰«æ (ä½¿ç”¨CMD_SPEED 0xF6æ¢æµ‹)
- âœ… æ³µå¯åŠ¨/åœæ­¢æ§åˆ¶
- âœ… è¿æ¥æŒ‰é’®çŠ¶æ€æ­£ç¡®æ˜¾ç¤º
- âœ… Fire-and-forgetæ¨¡å¼ (é’ˆå¯¹å“åº”ä¸ç¨³å®šè®¾å¤‡)
- âœ… æ³µ1ã€æ³µ11ç‰¹æ®Šå¤„ç† (å·²çŸ¥å“åº”å¼‚å¸¸ä½†å¯æ§åˆ¶)

**ç¡¬ä»¶æµ‹è¯•ç»“æœ** (2026-02-02):
- **æ‰€æœ‰12ä¸ªæ³µå‡æ­£å¸¸å·¥ä½œ** âœ…
- åœ¨çº¿æ³µæ‰«æç»“æœ: `[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]` âœ…
- æ³µ1ã€æ³µ11: ä½¿ç”¨fire_and_forgetæ¨¡å¼ï¼Œæ§åˆ¶æ­£å¸¸ âœ…

---

## â­ é˜¶æ®µ3ï¼šé…æ¶²åŠŸèƒ½ (å¾…å¼€å‘)

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ |
|------|------|------|
| Diluter | `src/echem_sdl/hardware/diluter.py` | â³ |
| LoggerService | `src/echem_sdl/services/logger_service.py` | â³ |

**å‰ç«¯å¯¹æ¥ç‚¹**: 
- `src/dialogs/config_dialog.py` - é…ç½®å¯¹è¯æ¡†
- `src/models.py` - DilutionChannel æ•°æ®æ¨¡å‹

---

## ğŸ”„ é˜¶æ®µ4ï¼šå†²æ´—åŠŸèƒ½ (å¾…å¼€å‘)

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ |
|------|------|------|
| Flusher | `src/echem_sdl/hardware/flusher.py` | â³ |

**å‰ç«¯å¯¹æ¥ç‚¹**: `src/dialogs/flusher_dialog.py`

---

## ğŸ”„ é˜¶æ®µ5ï¼šå®éªŒå¼•æ“ (å¾…å¼€å‘)

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ |
|------|------|------|
| ProgStep | `src/echem_sdl/core/prog_step.py` | â³ |
| ExpProgram | `src/echem_sdl/core/exp_program.py` | â³ |
| ExperimentEngine | `src/echem_sdl/engine/experiment_engine.py` | â³ |
| CHInstrument | `src/echem_sdl/hardware/chi_instrument.py` | â³ |

**å‰ç«¯å¯¹æ¥ç‚¹**: `src/ui/main_window.py` - å®Œæ•´å®éªŒæµç¨‹

---

## ğŸ“ ä¿®å¤æ—¥å¿—

### 2026-02-02 (æ™šé—´æ›´æ–°)

#### æ³µ1å’Œæ³µ11é€šä¿¡é—®é¢˜å®Œå…¨è§£å†³ âœ…

**é—®é¢˜æè¿°**:
1. æ³µ1å’Œæ³µ11å“åº”å¸§æ ¡éªŒå’ŒæŸåï¼Œå¯¼è‡´æ— æ³•é€šè¿‡æ­£å¸¸request()æ–¹æ³•æ§åˆ¶
2. æ‰«ææ—¶æ— æ³•æ£€æµ‹åˆ°æ³µ1å’Œæ³µ11ï¼ˆå³ä½¿å®ƒä»¬èƒ½æ¥æ”¶å¹¶æ‰§è¡Œå‘½ä»¤ï¼‰
3. æ‰‹åŠ¨æ§åˆ¶å¯¹è¯æ¡†ä¸­æ— æ³•æ§åˆ¶æ³µ1

**æ ¹æœ¬åŸå› åˆ†æ**:
- æ³µ1å’Œæ³µ11çš„ç¡¬ä»¶å­˜åœ¨æ ¡éªŒå’Œç”Ÿæˆé—®é¢˜ï¼Œè¿”å›çš„å“åº”å¸§checksumä¸æ­£ç¡®
- ä½†è¿™ä¸¤ä¸ªæ³µèƒ½æ­£ç¡®æ¥æ”¶å‘½ä»¤å¹¶æ‰§è¡Œï¼ˆå•å‘é€šä¿¡æ­£å¸¸ï¼‰
- æ ‡å‡†çš„request()æ–¹æ³•éœ€è¦ç­‰å¾…å“åº”éªŒè¯ï¼Œå¯¼è‡´è¶…æ—¶å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:

| ç»„ä»¶ | ä¿®å¤å†…å®¹ | æ–‡ä»¶ |
|------|---------|------|
| **PumpManager** | æ·»åŠ `fire_and_forget`å‚æ•°åˆ°`start_pump()`å’Œ`stop_pump()`ï¼Œå‘é€å‘½ä»¤åä¸ç­‰å¾…å“åº” | `pump_manager.py` |
| **PumpManager** | ä¿®å¤fire_and_forgetæ¨¡å¼ä½¿ç”¨é”™è¯¯ï¼š`write()` â†’ `send_frame()` | `pump_manager.py` |
| **PumpManager** | `scan_devices()`æ·»åŠ RESPONSE_UNSTABLE_PUMPSåˆ—è¡¨[1,11]ï¼Œå³ä½¿æ‰«æå¤±è´¥ä¹Ÿæ ‡è®°ä¸ºåœ¨çº¿ | `pump_manager.py` |
| **RS485Driver** | `discover_devices()`æ·»åŠ ç‰¹æ®Šå¤„ç†ï¼Œæ³µ1å’Œ11å³ä½¿ä¸å“åº”ä¹Ÿæ ‡è®°ä¸º"å·²çŸ¥å“åº”å¼‚å¸¸ä½†å¯æ§åˆ¶" | `rs485_driver.py` |
| **RS485Wrapper** | ç¡¬ç¼–ç æ³µ1å’Œ11å§‹ç»ˆä½¿ç”¨fire_and_forgetæ¨¡å¼ï¼ˆä¸ä¾èµ–æ‰«æç»“æœï¼‰ | `rs485_wrapper.py` |

**éªŒè¯æµ‹è¯•**:
- âœ… `test_scan_pump1.py`: æ‰«ææ£€æµ‹åˆ°æ‰€æœ‰12ä¸ªæ³µ
- âœ… `test_manual_control_pump1.py`: Mockæ¨¡å¼ä¸‹æ³µ1æ§åˆ¶æˆåŠŸ
- âœ… `test_real_hardware_pump1.py`: çœŸå®ç¡¬ä»¶ä¸Šæ³µ1å¯åŠ¨/åœæ­¢æˆåŠŸ

**æœ€ç»ˆç»“æœ**:
- æ‰€æœ‰12ä¸ªæ³µå‡èƒ½æ­£å¸¸æ‰«ææ£€æµ‹åˆ°
- æ³µ1å’Œ11ä½¿ç”¨fire_and_forgetæ¨¡å¼æ§åˆ¶ï¼Œå“åº”é€Ÿåº¦å¿«
- UIä¸­æ‰‹åŠ¨æ§åˆ¶å¯¹è¯æ¡†å¯ä»¥æ­£å¸¸æ§åˆ¶æ‰€æœ‰æ³µ
- ä¸ä¼šå› ä¸ºç­‰å¾…å“åº”è€Œå¯¼è‡´UIå¡é¡¿

---

### 2026-02-02 (æ—©æœŸæ›´æ–°)

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| Mockæ¨¡å¼åˆ‡æ¢ä¸ç”Ÿæ•ˆ | LibContextå•ä¾‹ä¸æ£€æµ‹mock_modeå˜åŒ– | æ·»åŠ `_current_mock_mode`è·Ÿè¸ª |
| ç«¯å£å‚æ•°æœªä¼ é€’ | RS485DriverAdapter.open()æœªè®¾ç½®å±æ€§ | æ˜¾å¼è®¾ç½®driver.port/baudrate |
| Mockæ¨¡å¼çŠ¶æ€æœªä¿å­˜ | SystemConfigç¼ºå°‘å­—æ®µ | æ·»åŠ mock_modeå­—æ®µ |
| è¿æ¥æŒ‰é’®çŠ¶æ€é”™è¯¯ | å¯¹è¯æ¡†é‡å¼€æ—¶æœªåˆ·æ–° | æ·»åŠ showEvent() |
| æ‰«æå‘½ä»¤å…¼å®¹æ€§ | 0xF1å‘½ä»¤éƒ¨åˆ†è®¾å¤‡ä¸å“åº” | æ”¹ç”¨0xF6 (é€Ÿåº¦0) æ¢æµ‹ |

---

*æœ€åæ›´æ–°: 2026å¹´2æœˆ2æ—¥ 23:20*
